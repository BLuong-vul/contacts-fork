<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UserControllerTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">java in middleware Coverage Results</a> &gt; <a href="index.source.html" class="el_package">com.vision.testing.controller</a> &gt; <span class="el_source">UserControllerTest.java</span></div><h1>UserControllerTest.java</h1><pre class="source lang-java linenums">package com.vision.testing.controller;

import com.vision.middleware.controller.UserController;
import com.vision.middleware.domain.ApplicationUser;
import com.vision.middleware.domain.relations.UserFollows;
import com.vision.middleware.service.FollowerService;
import com.vision.middleware.service.UserService;
import com.vision.middleware.utils.JwtUtil;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;

import java.util.Arrays;
import java.util.Date;
import java.util.List;

import static org.mockito.Mockito.*;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;

@ExtendWith(MockitoExtension.class)
<span class="fc" id="L29">public class UserControllerTest {</span>

    private MockMvc mockMvc;

    @Mock
    private UserService userService;

    @Mock
    private FollowerService followerService;

    @Mock
    private JwtUtil jwtUtil;

    @InjectMocks
    private UserController userController;

    @BeforeEach
    public void setUp() {
<span class="fc" id="L47">        mockMvc = MockMvcBuilders.standaloneSetup(userController).build();</span>
<span class="fc" id="L48">    }</span>

    @Test
    public void testHelloUserController() throws Exception {
<span class="fc" id="L52">        mockMvc.perform(get(&quot;/user/&quot;))</span>
<span class="fc" id="L53">                .andExpect(status().isOk())</span>
<span class="fc" id="L54">                .andExpect(content().string(&quot;User access level&quot;));</span>
<span class="fc" id="L55">    }</span>

    @Test
    public void testGetUserInfo() throws Exception {
<span class="fc" id="L59">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L60">        long userId = 1L;</span>
<span class="fc" id="L61">        ApplicationUser user = ApplicationUser.builder()</span>
<span class="fc" id="L62">                .id(userId)</span>
<span class="fc" id="L63">                .username(&quot;testUser&quot;)</span>
<span class="fc" id="L64">                .password(&quot;password&quot;)</span>
<span class="fc" id="L65">                .fullName(&quot;Test User&quot;)</span>
<span class="fc" id="L66">                .email(&quot;test@example.com&quot;)</span>
<span class="fc" id="L67">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L68">                .build();</span>

<span class="fc" id="L70">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>
<span class="fc" id="L71">        when(userService.loadUserById(userId)).thenReturn(user);</span>
<span class="fc" id="L72">        when(userService.getFollowerCount(user)).thenReturn(5);</span>
<span class="fc" id="L73">        when(userService.getFollowingCount(user)).thenReturn(10);</span>

<span class="fc" id="L75">        mockMvc.perform(get(&quot;/user/info&quot;)</span>
<span class="fc" id="L76">                        .header(&quot;Authorization&quot;, token))</span>
<span class="fc" id="L77">                .andExpect(status().isOk())</span>
<span class="fc" id="L78">                .andExpect(jsonPath(&quot;$.userId&quot;).value(userId))</span>
<span class="fc" id="L79">                .andExpect(jsonPath(&quot;$.username&quot;).value(&quot;testUser&quot;))</span>
<span class="fc" id="L80">                .andExpect(jsonPath(&quot;$.followerCount&quot;).value(5))</span>
<span class="fc" id="L81">                .andExpect(jsonPath(&quot;$.followingCount&quot;).value(10));</span>
<span class="fc" id="L82">    }</span>

    @Test
    public void testGetPublicInfoByUsername() throws Exception {
<span class="fc" id="L86">        String username = &quot;testUser&quot;;</span>
<span class="fc" id="L87">        ApplicationUser user = ApplicationUser.builder()</span>
<span class="fc" id="L88">                .id(1L)</span>
<span class="fc" id="L89">                .username(username)</span>
<span class="fc" id="L90">                .password(&quot;password&quot;)</span>
<span class="fc" id="L91">                .fullName(&quot;Test User&quot;)</span>
<span class="fc" id="L92">                .email(&quot;test@example.com&quot;)</span>
<span class="fc" id="L93">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L94">                .build();</span>

<span class="fc" id="L96">        when(userService.loadUserByUsername(username)).thenReturn(user);</span>
<span class="fc" id="L97">        when(userService.getFollowerCount(user)).thenReturn(5);</span>
<span class="fc" id="L98">        when(userService.getFollowingCount(user)).thenReturn(10);</span>

<span class="fc" id="L100">        mockMvc.perform(get(&quot;/user/public-info&quot;)</span>
<span class="fc" id="L101">                        .param(&quot;username&quot;, username))</span>
<span class="fc" id="L102">                .andExpect(status().isOk())</span>
<span class="fc" id="L103">                .andExpect(jsonPath(&quot;$.userId&quot;).value(1L))</span>
<span class="fc" id="L104">                .andExpect(jsonPath(&quot;$.username&quot;).value(username))</span>
<span class="fc" id="L105">                .andExpect(jsonPath(&quot;$.followerCount&quot;).value(5))</span>
<span class="fc" id="L106">                .andExpect(jsonPath(&quot;$.followingCount&quot;).value(10));</span>
<span class="fc" id="L107">    }</span>

    @Test
    public void testGetIdByUsername() throws Exception {
<span class="fc" id="L111">        String username = &quot;testUser&quot;;</span>
<span class="fc" id="L112">        ApplicationUser user = ApplicationUser.builder()</span>
<span class="fc" id="L113">                .id(1L)</span>
<span class="fc" id="L114">                .username(username)</span>
<span class="fc" id="L115">                .password(&quot;password&quot;)</span>
<span class="fc" id="L116">                .fullName(&quot;Test User&quot;)</span>
<span class="fc" id="L117">                .email(&quot;test@example.com&quot;)</span>
<span class="fc" id="L118">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L119">                .build();</span>

<span class="fc" id="L121">        when(userService.loadUserByUsername(username)).thenReturn(user);</span>

<span class="fc" id="L123">        mockMvc.perform(get(&quot;/user/id/{username}&quot;, username))</span>
<span class="fc" id="L124">                .andExpect(status().isOk())</span>
<span class="fc" id="L125">                .andExpect(content().string(&quot;1&quot;));</span>
<span class="fc" id="L126">    }</span>

    @Test
    public void testGetFollowing() throws Exception {
<span class="fc" id="L130">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L131">        long userId = 1L;</span>
<span class="fc" id="L132">        ApplicationUser user0 = ApplicationUser.builder()</span>
<span class="fc" id="L133">                .id(userId)</span>
<span class="fc" id="L134">                .username(&quot;user0&quot;)</span>
<span class="fc" id="L135">                .password(&quot;password&quot;)</span>
<span class="fc" id="L136">                .fullName(&quot;User Zero&quot;)</span>
<span class="fc" id="L137">                .email(&quot;user0@example.com&quot;)</span>
<span class="fc" id="L138">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L139">                .build();</span>
<span class="fc" id="L140">        ApplicationUser user1 = ApplicationUser.builder()</span>
<span class="fc" id="L141">                .id(2L)</span>
<span class="fc" id="L142">                .username(&quot;user1&quot;)</span>
<span class="fc" id="L143">                .password(&quot;password&quot;)</span>
<span class="fc" id="L144">                .fullName(&quot;User One&quot;)</span>
<span class="fc" id="L145">                .email(&quot;user1@example.com&quot;)</span>
<span class="fc" id="L146">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L147">                .build();</span>
<span class="fc" id="L148">        ApplicationUser user2 = ApplicationUser.builder()</span>
<span class="fc" id="L149">                .id(3L)</span>
<span class="fc" id="L150">                .username(&quot;user2&quot;)</span>
<span class="fc" id="L151">                .password(&quot;password&quot;)</span>
<span class="fc" id="L152">                .fullName(&quot;User Two&quot;)</span>
<span class="fc" id="L153">                .email(&quot;user2@example.com&quot;)</span>
<span class="fc" id="L154">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L155">                .build();</span>

<span class="fc" id="L157">        List&lt;UserFollows&gt; userFollowsList = Arrays.asList(</span>
<span class="fc" id="L158">                UserFollows.builder()</span>
<span class="fc" id="L159">                        .id(1L)</span>
<span class="fc" id="L160">                        .follower(user0)</span>
<span class="fc" id="L161">                        .followee(user1)</span>
<span class="fc" id="L162">                        .build(),</span>
<span class="fc" id="L163">                UserFollows.builder()</span>
<span class="fc" id="L164">                        .id(2L)</span>
<span class="fc" id="L165">                        .follower(user0)</span>
<span class="fc" id="L166">                        .followee(user2)</span>
<span class="fc" id="L167">                        .build()</span>
        );

<span class="fc" id="L170">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>
<span class="fc" id="L171">        when(followerService.getByFollowingUser(userId)).thenReturn(userFollowsList);</span>

<span class="fc" id="L173">        mockMvc.perform(get(&quot;/user/following/list&quot;)</span>
<span class="fc" id="L174">                        .header(&quot;Authorization&quot;, token))</span>
<span class="fc" id="L175">                .andExpect(status().isOk())</span>
<span class="fc" id="L176">                .andExpect(jsonPath(&quot;$[0].userId&quot;).value(2L))</span>
<span class="fc" id="L177">                .andExpect(jsonPath(&quot;$[0].username&quot;).value(&quot;user1&quot;))</span>
<span class="fc" id="L178">                .andExpect(jsonPath(&quot;$[1].userId&quot;).value(3L))</span>
<span class="fc" id="L179">                .andExpect(jsonPath(&quot;$[1].username&quot;).value(&quot;user2&quot;));</span>
<span class="fc" id="L180">    }</span>

    @Test
    public void testGetFollowers() throws Exception {
<span class="fc" id="L184">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L185">        long userId = 1L;</span>
<span class="fc" id="L186">        ApplicationUser user0 = ApplicationUser.builder()</span>
<span class="fc" id="L187">                .id(userId)</span>
<span class="fc" id="L188">                .username(&quot;user0&quot;)</span>
<span class="fc" id="L189">                .password(&quot;password&quot;)</span>
<span class="fc" id="L190">                .fullName(&quot;User Zero&quot;)</span>
<span class="fc" id="L191">                .email(&quot;user0@example.com&quot;)</span>
<span class="fc" id="L192">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L193">                .build();</span>
<span class="fc" id="L194">        ApplicationUser user1 = ApplicationUser.builder()</span>
<span class="fc" id="L195">                .id(2L)</span>
<span class="fc" id="L196">                .username(&quot;user1&quot;)</span>
<span class="fc" id="L197">                .password(&quot;password&quot;)</span>
<span class="fc" id="L198">                .fullName(&quot;User One&quot;)</span>
<span class="fc" id="L199">                .email(&quot;user1@example.com&quot;)</span>
<span class="fc" id="L200">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L201">                .build();</span>
<span class="fc" id="L202">        ApplicationUser user2 = ApplicationUser.builder()</span>
<span class="fc" id="L203">                .id(3L)</span>
<span class="fc" id="L204">                .username(&quot;user2&quot;)</span>
<span class="fc" id="L205">                .password(&quot;password&quot;)</span>
<span class="fc" id="L206">                .fullName(&quot;User Two&quot;)</span>
<span class="fc" id="L207">                .email(&quot;user2@example.com&quot;)</span>
<span class="fc" id="L208">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L209">                .build();</span>

<span class="fc" id="L211">        List&lt;UserFollows&gt; userFollowersRelation = Arrays.asList(</span>
<span class="fc" id="L212">                UserFollows.builder()</span>
<span class="fc" id="L213">                        .id(1L)</span>
<span class="fc" id="L214">                        .follower(user1)</span>
<span class="fc" id="L215">                        .followee(user0)</span>
<span class="fc" id="L216">                        .build(),</span>
<span class="fc" id="L217">                UserFollows.builder()</span>
<span class="fc" id="L218">                        .id(2L)</span>
<span class="fc" id="L219">                        .follower(user2)</span>
<span class="fc" id="L220">                        .followee(user0)</span>
<span class="fc" id="L221">                        .build()</span>
        );

<span class="fc" id="L224">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>
<span class="fc" id="L225">        when(followerService.getByFolloweeUser(userId)).thenReturn(userFollowersRelation);</span>

<span class="fc" id="L227">        mockMvc.perform(get(&quot;/user/followers/list&quot;)</span>
<span class="fc" id="L228">                        .header(&quot;Authorization&quot;, token))</span>
<span class="fc" id="L229">                .andExpect(status().isOk())</span>
<span class="fc" id="L230">                .andExpect(jsonPath(&quot;$[0].userId&quot;).value(2L))</span>
<span class="fc" id="L231">                .andExpect(jsonPath(&quot;$[0].username&quot;).value(&quot;user1&quot;))</span>
<span class="fc" id="L232">                .andExpect(jsonPath(&quot;$[1].userId&quot;).value(3L))</span>
<span class="fc" id="L233">                .andExpect(jsonPath(&quot;$[1].username&quot;).value(&quot;user2&quot;));</span>
<span class="fc" id="L234">    }</span>

    @Test
    public void testFollowUser() throws Exception {
<span class="fc" id="L238">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L239">        long followerId = 1L;</span>
<span class="fc" id="L240">        long followeeId = 2L;</span>

<span class="fc" id="L242">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(followerId);</span>

<span class="fc" id="L244">        mockMvc.perform(post(&quot;/user/follow/{followeeId}&quot;, followeeId)</span>
<span class="fc" id="L245">                        .header(&quot;Authorization&quot;, token))</span>
<span class="fc" id="L246">                .andExpect(status().isOk())</span>
<span class="fc" id="L247">                .andExpect(content().string(&quot;User 2 followed&quot;));</span>
<span class="fc" id="L248">    }</span>

    @Test
    public void testUnfollowUser() throws Exception {
<span class="fc" id="L252">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L253">        long followerId = 1L;</span>
<span class="fc" id="L254">        long followeeId = 2L;</span>

<span class="fc" id="L256">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(followerId);</span>

<span class="fc" id="L258">        mockMvc.perform(post(&quot;/user/unfollow/{followeeId}&quot;, followeeId)</span>
<span class="fc" id="L259">                        .header(&quot;Authorization&quot;, token))</span>
<span class="fc" id="L260">                .andExpect(status().isOk())</span>
<span class="fc" id="L261">                .andExpect(content().string(&quot;User 2 unfollowed&quot;));</span>
<span class="fc" id="L262">    }</span>

    @Test
    public void testSearchUsers_ValidQuery() throws Exception {
<span class="fc" id="L266">        String query = &quot;test&quot;;</span>
<span class="fc" id="L267">        ApplicationUser user1 = ApplicationUser.builder()</span>
<span class="fc" id="L268">                .id(1L)</span>
<span class="fc" id="L269">                .username(&quot;testUser1&quot;)</span>
<span class="fc" id="L270">                .password(&quot;password&quot;)</span>
<span class="fc" id="L271">                .fullName(&quot;Test User One&quot;)</span>
<span class="fc" id="L272">                .email(&quot;test1@example.com&quot;)</span>
<span class="fc" id="L273">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L274">                .build();</span>
<span class="fc" id="L275">        ApplicationUser user2 = ApplicationUser.builder()</span>
<span class="fc" id="L276">                .id(2L)</span>
<span class="fc" id="L277">                .username(&quot;testUser2&quot;)</span>
<span class="fc" id="L278">                .password(&quot;password&quot;)</span>
<span class="fc" id="L279">                .fullName(&quot;Test User Two&quot;)</span>
<span class="fc" id="L280">                .email(&quot;test2@example.com&quot;)</span>
<span class="fc" id="L281">                .phoneNumber(&quot;1234567890&quot;)</span>
<span class="fc" id="L282">                .build();</span>

<span class="fc" id="L284">        List&lt;ApplicationUser&gt; users = Arrays.asList(user1, user2);</span>

<span class="fc" id="L286">        when(userService.searchUsers(query)).thenReturn(users);</span>

<span class="fc" id="L288">        mockMvc.perform(get(&quot;/user/search&quot;)</span>
<span class="fc" id="L289">                        .param(&quot;query&quot;, query))</span>
<span class="fc" id="L290">                .andExpect(status().isOk())</span>
<span class="fc" id="L291">                .andExpect(jsonPath(&quot;$[0].userId&quot;).value(1L))</span>
<span class="fc" id="L292">                .andExpect(jsonPath(&quot;$[0].username&quot;).value(&quot;testUser1&quot;))</span>
<span class="fc" id="L293">                .andExpect(jsonPath(&quot;$[1].userId&quot;).value(2L))</span>
<span class="fc" id="L294">                .andExpect(jsonPath(&quot;$[1].username&quot;).value(&quot;testUser2&quot;));</span>
<span class="fc" id="L295">    }</span>

    @Test
    public void testSearchUsers_InvalidQuery() throws Exception {
<span class="fc" id="L299">        String query = &quot;&quot;;</span>

<span class="fc" id="L301">        mockMvc.perform(get(&quot;/user/search&quot;)</span>
<span class="fc" id="L302">                        .param(&quot;query&quot;, query))</span>
<span class="fc" id="L303">                .andExpect(status().isBadRequest());</span>
<span class="fc" id="L304">    }</span>

    @Test
    public void testUpdateDisplayNameById() throws Exception {
<span class="fc" id="L308">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L309">        long userId = 1L;</span>
<span class="fc" id="L310">        String displayName = &quot;newDisplayName&quot;;</span>

<span class="fc" id="L312">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>

<span class="fc" id="L314">        mockMvc.perform(post(&quot;/user/account/displayName&quot;)</span>
<span class="fc" id="L315">                        .header(&quot;Authorization&quot;, token)</span>
<span class="fc" id="L316">                        .param(&quot;displayName&quot;, displayName))</span>
<span class="fc" id="L317">                .andExpect(status().isOk());</span>
<span class="fc" id="L318">    }</span>

    @Test
    public void testUpdateBioById() throws Exception {
<span class="fc" id="L322">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L323">        long userId = 1L;</span>
<span class="fc" id="L324">        String bio = &quot;newBio&quot;;</span>

<span class="fc" id="L326">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>

<span class="fc" id="L328">        mockMvc.perform(post(&quot;/user/account/bio&quot;)</span>
<span class="fc" id="L329">                        .header(&quot;Authorization&quot;, token)</span>
<span class="fc" id="L330">                        .param(&quot;bio&quot;, bio))</span>
<span class="fc" id="L331">                .andExpect(status().isOk());</span>
<span class="fc" id="L332">    }</span>

    @Test
    public void testUpdateOccupationById() throws Exception {
<span class="fc" id="L336">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L337">        long userId = 1L;</span>
<span class="fc" id="L338">        String occupation = &quot;newOccupation&quot;;</span>

<span class="fc" id="L340">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>

<span class="fc" id="L342">        mockMvc.perform(post(&quot;/user/account/occupation&quot;)</span>
<span class="fc" id="L343">                        .header(&quot;Authorization&quot;, token)</span>
<span class="fc" id="L344">                        .param(&quot;occupation&quot;, occupation))</span>
<span class="fc" id="L345">                .andExpect(status().isOk());</span>
<span class="fc" id="L346">    }</span>

    @Test
    public void testUpdateLocationById() throws Exception {
<span class="fc" id="L350">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L351">        long userId = 1L;</span>
<span class="fc" id="L352">        String location = &quot;newLocation&quot;;</span>

<span class="fc" id="L354">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>

<span class="fc" id="L356">        mockMvc.perform(post(&quot;/user/account/location&quot;)</span>
<span class="fc" id="L357">                        .header(&quot;Authorization&quot;, token)</span>
<span class="fc" id="L358">                        .param(&quot;location&quot;, location))</span>
<span class="fc" id="L359">                .andExpect(status().isOk());</span>
<span class="fc" id="L360">    }</span>

    @Test
    public void testUpdateBirthdateById() throws Exception {
<span class="fc" id="L364">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L365">        long userId = 1L;</span>
<span class="fc" id="L366">        Date birthdate = new Date();</span>

<span class="fc" id="L368">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>

<span class="fc" id="L370">        mockMvc.perform(post(&quot;/user/account/birthdate&quot;)</span>
<span class="fc" id="L371">                        .header(&quot;Authorization&quot;, token)</span>
<span class="fc" id="L372">                        .param(&quot;birthdate&quot;, birthdate.toString()))</span>
<span class="fc" id="L373">                .andExpect(status().isOk());</span>
<span class="fc" id="L374">    }</span>


    @Test
    public void testUpdateProfilePictureFileName() throws Exception {
<span class="fc" id="L379">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L380">        long userId = 1L;</span>
<span class="fc" id="L381">        String profilePictureFileName = &quot;newProfilePicture.jpg&quot;;</span>

<span class="fc" id="L383">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>

<span class="fc" id="L385">        mockMvc.perform(post(&quot;/user/account/profile-picture-file-name&quot;)</span>
<span class="fc" id="L386">                        .header(&quot;Authorization&quot;, token)</span>
<span class="fc" id="L387">                        .param(&quot;profile-picture-file-name&quot;, profilePictureFileName))</span>
<span class="fc" id="L388">                .andExpect(status().isOk());</span>

        // Verify the service method was called with the correct parameters
<span class="fc" id="L391">        verify(userService, times(1)).updateProfilePictureById(userId, profilePictureFileName);</span>
<span class="fc" id="L392">    }</span>

    @Test
    void testUpdateBannerPictureFileName_Success() throws Exception {
        // Arrange
<span class="fc" id="L397">        String token = &quot;validToken&quot;;</span>
<span class="fc" id="L398">        long userId = 1L;</span>
<span class="fc" id="L399">        String bannerPictureFileName = &quot;new-banner.jpg&quot;;</span>

<span class="fc" id="L401">        when(jwtUtil.checkJwtAuthAndGetUserId(token)).thenReturn(userId);</span>

        // Act &amp; Assert
<span class="fc" id="L404">        mockMvc.perform(post(&quot;/user/account/banner-picture-file-name&quot;)</span>
<span class="fc" id="L405">                        .header(&quot;Authorization&quot;, token)</span>
<span class="fc" id="L406">                        .param(&quot;banner-picture-file-name&quot;, bannerPictureFileName))</span>
<span class="fc" id="L407">                .andDo(print())</span>
<span class="fc" id="L408">                .andExpect(status().isOk());</span>

        // Verify that the service method was called with correct parameters
<span class="fc" id="L411">        verify(userService, times(1)).updateBannerPictureById(userId, bannerPictureFileName);</span>
<span class="fc" id="L412">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>